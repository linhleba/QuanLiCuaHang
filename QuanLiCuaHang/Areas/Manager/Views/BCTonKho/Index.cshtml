@model IEnumerable<QuanLiCuaHang.Areas.Manager.Data.BCTONKHO>

@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Manager/Views/Shared/_Layout.cshtml";
}
<script src="~/Assets/Manager/dist/js/FileSaver.js.js"></script>


<script type="text/javascript">
    // Hàm chọn sản phẩm hiển thị đơn giá, đơn vị tinnhs
    $(document).ready(function () {
        document.getElementById('lbThang').innerHTML = $("#searchThang").val();
        document.getElementById('lbNam').innerHTML = $("#searchNam").val();

        $("#searchThang").change(function () {
            var thang = $("#searchThang").val();
            $("#Thang").val(thang);
 
        });

        $("#searchNam").change(function () {
            var nam = $("#searchNam").val();
            $("#Nam").val(nam);
   
        });


        //$("#searchSubmit").click(function () {
        //    alert("yes");
        //    //$("#submit").click();
        //    //$("input[name='submit']").eq[0].trigger("click");
        //    return false;
        
        //});
    });

    function fnExcelReport(id, name) {
        var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
        tab_text = tab_text + '<head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';
        tab_text = tab_text + '<x:Name>Test Sheet</x:Name>';
        tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
        tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';
        tab_text = tab_text + "<table border='1px'>";
        var exportTable = $('#' + id).clone();
        exportTable.find('input').each(function (index, elem) { $(elem).remove(); });
        tab_text = tab_text + exportTable.html();
        tab_text = tab_text + '</table></body></html>';
        var fileName = name + '_' + parseInt(Math.random() * 10000000000) + '.xls';

        //Save the file
        var blob = new Blob([tab_text], { type: "application/vnd.ms-excel;charset=utf-8" })
        window.saveAs(blob, fileName);
    }
</script>
<div class="card-body">
    @using (Html.BeginForm("Index", "BCTonKho", FormMethod.Get))
    {
        {
            @*@Html.AntiForgeryToken()*@

    <div class="form-horizontal">
       <h1 style="border-bottom: 3px solid #e5e5e5; text-align: center"> TẠO BÁO CÁO TỒN KHO </h1>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })


    <fieldset>

        <div class="container-fluid">
            <div class="row">
                <div class="row col-md-2">
                    <div class="form-group">
                        <label>Chọn tháng</label>

                        @*<input style="width:80px" type="text" class="form-control" required>*@
                        @*@Html.TextBox("Thang")*@

                        @Html.EditorFor(model => model.FirstOrDefault().Thang, new { htmlAttributes = new { @class = "form-control", style = "width:80px", @id = "searchThang" } })
                        @Html.ValidationMessageFor(model => model.FirstOrDefault().Thang, "", new { @class = "text-danger" })

                    </div>
                </div>


                <div class="row col-md-2">
                    <div class="form-group">
                        <label>Chọn năm</label>

                        @*<input style="width:80px" type="text" class="form-control" required>*@
                        @Html.EditorFor(model => model.FirstOrDefault().Nam, new { htmlAttributes = new { @class = "form-control", style = "width:80px", @id = "searchNam" } })
                        @Html.ValidationMessageFor(model => model.FirstOrDefault().Nam, "", new { @class = "text-danger" })
                    </div>
                </div>



            </div>
        </div>
        <div class="form-group">
            @*<input name="searchSubmit" id="searchSubmit" type="submit" style="margin-left:15px" class="btn btn-primary" value="Thêm" />*@
            <button id="searchSubmit" type="submit" name="searchSubmit" style="margin-left:15px; float: left" class="btn btn-primary"> Tra cứu </button>
        </div>

     
    </fieldset>
             </div>
        }
    }


    @using (Html.BeginForm("Create", "BCTonKho", FormMethod.Post))
    {
        {
            @Html.AntiForgeryToken()

<div class="form-horizontal">
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })


    @*<fieldset>

        <div class="container-fluid" hidden>*@
            @*<div class="row">*@
                <div class="row col-md-2" hidden >
                    <div class="form-group">
                        <label>Chọn tháng</label>

                        @*<input style="width:80px" type="text" class="form-control" required>*@
                        @*@Html.TextBox("Thang")*@

                        @Html.EditorFor(model => model.FirstOrDefault().Thang, new { htmlAttributes = new { @class = "form-control", style = "width:80px", @id = "Thang" } })
                        @Html.ValidationMessageFor(model => model.FirstOrDefault().Thang, "", new { @class = "text-danger" })

                    </div>
                </div>


                <div class="row col-md-2" hidden>
                    <div class="form-group">
                        <label>Chọn năm</label>

                        @*<input style="width:80px" type="text" class="form-control" required>*@
                        @Html.TextBoxFor(model => model.FirstOrDefault().Nam, new { htmlAttributes = new { @class = "form-control", style = "width:80px", @id = "Nam" } })
                        @Html.ValidationMessageFor(model => model.FirstOrDefault().Nam, "", new { @class = "text-danger" })
                    </div>
                </div>



            @*</div>*@
        @*</div>*@
        <div class="form-group">
            <input name="submit" id="submit" type="submit" style="margin-left:150px; margin-top: -100px" class="btn btn-primary" value="Tạo báo cáo" />
        </div>

    @*</fieldset>*@


</div>
        }
 }



<div class="table-responsive">
    <button style="float:right" class="btn btn-success" onclick="javascript: fnExcelReport('datatable-editable','data')">
        <i class="fa fa-file-excel-o"></i> Xuất Excel
    </button>
 
    @*<H4 style="text-align:center">
        BÁO CÁO TỒN KHO THÁNG
        <label id="lbThang"> 5 </label> / <label id="lbNam"> 2020 </label>
    </H4>*@
    <table class="table table-bordered table-striped mb-none" id="datatable-editable" width="100%" cellspacing="0">
       
        <thead>
        
            <tr>
                <th colspan="5" style="background-color: lightsteelblue">
                   
                    <h4 style="text-align:center; font-weight:bold"> BÁO CÁO TỒN KHO THÁNG <label id="lbThang"> _ </label> / <label id="lbNam"> _ </label> </h4>

                </th>
            </tr>
            <tr>
                <th>Tên loại sản phẩm</th>
                <th>Tồn đầu</th>
                <th>Tồn cuối</th>
                <th>Số lượng mua vào</th>
                <th>Số lượng bán ra</th>
            </tr>
        </thead>
        <tbody>


            @foreach (var item in Model)
            {

                <tr>
                    <td style="text-align:center">
                        @Html.DisplayFor(modelItem => item.SANPHAM.TenSanPham)
                    </td>
                    <td style="text-align:center">
                        @Html.DisplayFor(modelItem => item.Tondau)
                    </td>
                    <td style="text-align:center">
                        @Html.DisplayFor(modelItem => item.TonCuoi)
                    </td>
                    <td style="text-align:center">
                        @Html.DisplayFor(modelItem => item.SLMuaVao)
                    </td>
                    <td style="text-align:center">
                        @Html.DisplayFor(modelItem => item.SLBanRa)
                    </td>

                </tr>

            }


        </tbody>
    </table>
    @*@using (Html.BeginForm("Export", "BCTonKho", FormMethod.Post))
    {
        <input type="submit" value="Export" />
    }*@

</div>
</div>

